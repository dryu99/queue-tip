(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{115:function(e,t){},124:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),o=a.n(c),u=a(33),l=a(8),m=a(129),i=a(131),s=a(70),E=a(134),d=a(6),f=Object.freeze({ADMIN:"admin",BASIC:"basic"}),v=function(){},U=v,b=function(){var e;(e=console).error.apply(e,arguments)},O=a(68),p=a.n(O)()(),N=function(e,t){p.emit(j.DEQUEUE,e,t)},j=Object.freeze({JOIN:"join",CREATE_ROOM:"create_room",DISCONNECT:"disconnect",LEAVE:"leave",NEW_USER_JOIN:"new_user_join",ROOM_CHECK:"room_check",ENQUEUE:"enqueue",DEQUEUE:"dequeue",UPDATE_USER:"update_user"}),y=p,C=function(e){var t=e.setCurrentUserType,a=e.setRoom,c=e.setRoomError,o=Object(n.useState)(""),u=Object(l.a)(o,2),v=u[0],O=u[1],N=Object(d.f)();return r.a.createElement(m.a,{className:"mt-4"},r.a.createElement("h1",{className:"text-center mb-5"},"queue-tip"),r.a.createElement(i.a,null,r.a.createElement(i.a.Row,{className:"justify-content-center mb-3"},r.a.createElement(s.a,{xs:"auto"},r.a.createElement(i.a.Label,null,"Room Name"),r.a.createElement(i.a.Control,{value:v,onChange:function(e){return O(e.target.value)},placeholder:"CPSC 110 Office Hours"}))),r.a.createElement(i.a.Row,{className:"justify-content-center"},r.a.createElement(s.a,{xs:"auto"},r.a.createElement(E.a,{onClick:function(e){var n,r;e.preventDefault(),v&&""!==v.trim()?(t(f.ADMIN),U("emitting room creation event"),n={name:v},r=function(e){var t=e.room,n=e.error;t&&!n?(a(t),N.push("/room/".concat(e.room.id))):(b(n),c("sorry room doesn't exist..."))},p.emit(j.CREATE_ROOM,n,r)):b('can"t submit room with empty name!')},variant:"primary",type:"submit"},"Create Room")))))},I=a(32),h=a(130),g=["Mr. Recursion","Prof. G","Gregor Kiczales"],k=function(e){var t=e.user,a=e.room,c=e.setUser,u=e.addNewUser,d=e.addNewQueueUser,f=Object(n.useState)(""),v=Object(l.a)(f,2),O=v[0],N=v[1],y=Object(n.useState)(""),C=Object(l.a)(y,2),h=C[0],k=C[1],R=r.a.createRef();Object(n.useEffect)((function(){o.a.findDOMNode(R.current).focus()}),[R]);var x=Math.floor(g.length*Math.random()),A=g[x];return r.a.createElement(m.a,{className:"mt-4"},r.a.createElement("h1",{className:"text-center mb-5"},"Sign In"),r.a.createElement(i.a,null,r.a.createElement(i.a.Row,{className:"justify-content-center mb-3"},r.a.createElement(s.a,{xs:"auto"},r.a.createElement(i.a.Label,null,"Your Name"),r.a.createElement(i.a.Control,{ref:R,value:O,onChange:function(e){return N(e.target.value)},placeholder:A}))),r.a.createElement(i.a.Row,{className:"justify-content-center mb-3"},r.a.createElement(s.a,{xs:"auto"},r.a.createElement(i.a.Text,{className:"text-muted"},h))),r.a.createElement(i.a.Row,{className:"justify-content-center"},r.a.createElement(s.a,{xs:"auto"},r.a.createElement(E.a,{onClick:function(e){var n,r;e.preventDefault(),""!==O.trim()?(n={name:O,type:t.type,roomId:a.id},r=function(e){var t=e.user,a=e.usersInRoom,n=e.usersInQueue,r=e.error;U("acknowledged from JOIN event",t),r?(b(r),k("Name is already taken, please try something else.")):(c(t),u([].concat(Object(I.a)(a),[t])),d(n))},p.emit(j.JOIN,n,r)):k("Your name can't be empty!")},variant:"primary",type:"submit"},"Enter Room")))))},R=a(133),x=function(e){var t=e.user,a=e.isCurrentUser,n=t.type===f.ADMIN,c=n?"text-danger":a?"text-primary":"";return r.a.createElement("span",{className:c},t.name," ",n?"(admin)":"")},A=function(e){var t=e.room,a=e.user,n=e.queueUsers,c=e.removeQueueUser,o=e.setInQueue;return r.a.createElement("div",null,r.a.createElement("h4",null,"Queue"),r.a.createElement(R.a,null,n.map((function(e,n){var u=a.name===e.name,l=a.type===f.ADMIN,i={action:!!l,onClick:l?function(n){return r=e.id,void N({userId:r,roomId:t.id},(function(e){U("acknowledged from DEQUEUE event",e.dequeuedUser),c(e.dequeuedUser.id),e.dequeuedUser.id===a.id&&o(!1)}));var r}:null};return r.a.createElement(m.a,{key:e.id},r.a.createElement(h.a,{className:"align-items-center"},r.a.createElement(s.a,{xs:"auto"},r.a.createElement("b",null,n+1)),r.a.createElement(s.a,null,r.a.createElement(R.a.Item,i,r.a.createElement(x,{user:e,isCurrentUser:u})))))}))))},w=a(73),D=a(132),S=a(135),Q=function(e){var t=e.makeAdmin,a=e.user;delete e.makeAdmin,delete e.user;return r.a.createElement(S.a,e,r.a.createElement(S.a.Content,null,r.a.createElement(R.a,{variant:"flush"},r.a.createElement(R.a.Item,{action:!0,onClick:function(){console.log("only here"),t(a)}},"Make Admin"))))},_=function(e){var t=e.children,a=Object(w.a)(e,["children"]);return r.a.createElement(D.a,{rootClose:!0,trigger:"click",placement:"left",overlay:Q(a)},t)},M=function(e){var t=e.user,a=e.users,n=e.makeAdmin;return r.a.createElement("div",null,r.a.createElement("h4",null,"Users: ",a.length),r.a.createElement(R.a,null,a.map((function(e){var a=t.name===e.name,c=t.type===f.ADMIN,o={action:!!c},u=r.a.createElement(R.a.Item,Object.assign({key:e.id},o),r.a.createElement(x,{user:e,isCurrentUser:a}));return c?r.a.createElement(_,{key:e.id,makeAdmin:n,user:e},u):u}))))},q=function(e){var t=e.room,a=e.user,c=e.setUser,o=Object(n.useState)([]),i=Object(l.a)(o,2),d=i[0],v=i[1],O=Object(n.useState)([]),C=Object(l.a)(O,2),g=C[0],R=C[1],x=Object(n.useState)(!1),w=Object(l.a)(x,2),D=w[0],S=w[1];Object(n.useEffect)((function(){return y.on(j.NEW_USER_JOIN,(function(e){var t=e.newUser;U("received JOIN event",t),Q(t)})),y.on(j.LEAVE,(function(e){var t=e.leftUser;U("received LEAVE event",t),_(t.id),T(t.id)})),y.on(j.ENQUEUE,(function(e){var t=e.enqueuedUser;U("received ENQUEUE event",t),q(t)})),y.on(j.DEQUEUE,(function(e){var t=e.dequeuedUser;U("received DEQUEUE event",t),T(t.id),t.id===a.id&&S(!1)})),y.on(j.UPDATE_USER,(function(e){var t=e.updatedUser;U("received UPDATE_USER event",t),J(t),t.id===a.id&&c(t)})),function(){y.emit(j.DISCONNECT),y.off()}}),[d,g]);var Q=function(e){v(d.concat(e))},_=function(e){v(d.filter((function(t){return t.id!==e})))},q=function(e){R(g.concat(e))},T=function(e){R(g.filter((function(t){return t.id!==e})))},J=function(e){var t=d.findIndex((function(t){return t.id===e.id}));if(-1!==t){var a=Object(I.a)(d);a.splice(t,1,e),v(a)}else b("couldn't find user ".concat(e.name," so couldn't update them"))},L=a&&a.name&&a.id;return r.a.createElement(m.a,{className:"mt-4"},t&&L?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,null,r.a.createElement(s.a,null,r.a.createElement("h1",null,t.name)),r.a.createElement(s.a,{xs:"auto"},r.a.createElement(E.a,{onClick:function(){var e=document.createElement("textarea");document.body.appendChild(e),e.value=window.location.href,e.select(),document.execCommand("copy"),document.body.removeChild(e)},size:"lg",variant:"secondary"},"Copy Link")),r.a.createElement(s.a,{xs:"3"},r.a.createElement(E.a,{onClick:function(){var e,n;D?N({userId:a.id,roomId:t.id},(function(e){U("acknowledged from DEQUEUE event",e);var t=e.dequeuedUser,a=e.error;a?b(a):(T(t.id),S(!1))})):(e={userId:a.id,roomId:t.id},n=function(e){U("acknowledged from ENQUEUE event",e);var t=e.enqueuedUser,a=e.error;a?b(a):(q(t),S(!0))},p.emit(j.ENQUEUE,e,n))},size:"lg",block:!0},D?"Leave Queue":"Join Queue"))),r.a.createElement("hr",null),r.a.createElement(h.a,null,r.a.createElement(s.a,null,r.a.createElement(A,{room:t,user:a,queueUsers:g,removeQueueUser:T,setInQueue:S})),r.a.createElement(s.a,{xs:"3"},r.a.createElement(M,{user:a,users:d,makeAdmin:function(e){var t=Object(u.a)({},e,{type:f.ADMIN});y.emit(j.UPDATE_USER,t,(function(e){U("acknowledged from UPDATE_USER event",e);var t=e.updatedUser;e.error||J(t)}))}})))):r.a.createElement(k,{room:t,user:a,setUser:c,addNewUser:Q,addNewQueueUser:q}))},T=function(e){var t=e.text;return r.a.createElement("div",null,t)};var J=function(){var e=Object(n.useState)({type:f.BASIC}),t=Object(l.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),m=Object(l.a)(o,2),i=m[0],s=m[1],E=Object(n.useState)(null),v=Object(l.a)(E,2),O=v[0],N=v[1],y=Object(d.g)("/room/:id");return Object(n.useEffect)((function(){var e,t;y&&!i&&(U("emitting room check event"),e=y.params.id,t=function(e){var t=e.room,a=e.error;U("room event acknowledged",t),t&&!a?s(t):(b(a),N("sorry room doesn't exist..."))},p.emit(j.ROOM_CHECK,{roomId:e},t))}),[y,i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(d.c,{className:"mt-4"},r.a.createElement(d.a,{path:"/room/:id"},O?r.a.createElement(T,{text:O}):r.a.createElement(q,{room:i,user:a,setUser:c})),r.a.createElement(d.a,{exact:!0,path:"/"},r.a.createElement(C,{setCurrentUserType:function(e){c(Object(u.a)({},a,{type:e}))},setRoom:s,setRoomError:N})),r.a.createElement(d.a,null,r.a.createElement(T,{text:"404 resource not found"}))))},L=a(25);o.a.render(r.a.createElement(L.a,null,r.a.createElement(J,null)),document.getElementById("root"))},80:function(e,t,a){e.exports=a(124)}},[[80,1,2]]]);
//# sourceMappingURL=main.1335e009.chunk.js.map